// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: dns_records.sql

package dnsdb

import (
	"context"
)

const createDnsRecord = `-- name: CreateDnsRecord :one
INSERT INTO dns_records (id, zone_id, name, rrtype, content, ttl, managed, service_id)
VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING id, zone_id, name, rrtype, content, ttl, managed, service_id, created_at
`

type CreateDnsRecordParams struct {
	ID        string  `json:"id"`
	ZoneID    string  `json:"zone_id"`
	Name      string  `json:"name"`
	Rrtype    string  `json:"rrtype"`
	Content   string  `json:"content"`
	Ttl       int32   `json:"ttl"`
	Managed   bool    `json:"managed"`
	ServiceID *string `json:"service_id"`
}

func (q *Queries) CreateDnsRecord(ctx context.Context, arg CreateDnsRecordParams) (DnsRecord, error) {
	row := q.db.QueryRow(ctx, createDnsRecord,
		arg.ID,
		arg.ZoneID,
		arg.Name,
		arg.Rrtype,
		arg.Content,
		arg.Ttl,
		arg.Managed,
		arg.ServiceID,
	)
	var i DnsRecord
	err := row.Scan(
		&i.ID,
		&i.ZoneID,
		&i.Name,
		&i.Rrtype,
		&i.Content,
		&i.Ttl,
		&i.Managed,
		&i.ServiceID,
		&i.CreatedAt,
	)
	return i, err
}

const deleteDnsRecord = `-- name: DeleteDnsRecord :exec
DELETE FROM dns_records WHERE id = $1
`

func (q *Queries) DeleteDnsRecord(ctx context.Context, id string) error {
	_, err := q.db.Exec(ctx, deleteDnsRecord, id)
	return err
}

const getDnsRecordByID = `-- name: GetDnsRecordByID :one
SELECT id, zone_id, name, rrtype, content, ttl, managed, service_id, created_at FROM dns_records WHERE id = $1
`

func (q *Queries) GetDnsRecordByID(ctx context.Context, id string) (DnsRecord, error) {
	row := q.db.QueryRow(ctx, getDnsRecordByID, id)
	var i DnsRecord
	err := row.Scan(
		&i.ID,
		&i.ZoneID,
		&i.Name,
		&i.Rrtype,
		&i.Content,
		&i.Ttl,
		&i.Managed,
		&i.ServiceID,
		&i.CreatedAt,
	)
	return i, err
}

const listCustomDomainsByServiceIDs = `-- name: ListCustomDomainsByServiceIDs :many
SELECT dr.service_id, dr.name, hz.zone, hz.status
FROM dns_records dr
JOIN hosted_zones hz ON dr.zone_id = hz.id
WHERE dr.service_id = ANY($1::text[])
  AND dr.service_id IS NOT NULL
`

type ListCustomDomainsByServiceIDsRow struct {
	ServiceID *string `json:"service_id"`
	Name      string  `json:"name"`
	Zone      string  `json:"zone"`
	Status    string  `json:"status"`
}

func (q *Queries) ListCustomDomainsByServiceIDs(ctx context.Context, dollar_1 []string) ([]ListCustomDomainsByServiceIDsRow, error) {
	rows, err := q.db.Query(ctx, listCustomDomainsByServiceIDs, dollar_1)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []ListCustomDomainsByServiceIDsRow{}
	for rows.Next() {
		var i ListCustomDomainsByServiceIDsRow
		if err := rows.Scan(
			&i.ServiceID,
			&i.Name,
			&i.Zone,
			&i.Status,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listDnsRecordsByServiceID = `-- name: ListDnsRecordsByServiceID :many
SELECT id, zone_id, name, rrtype, content, ttl, managed, service_id, created_at FROM dns_records
WHERE service_id = $1
ORDER BY created_at DESC
`

func (q *Queries) ListDnsRecordsByServiceID(ctx context.Context, serviceID *string) ([]DnsRecord, error) {
	rows, err := q.db.Query(ctx, listDnsRecordsByServiceID, serviceID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []DnsRecord{}
	for rows.Next() {
		var i DnsRecord
		if err := rows.Scan(
			&i.ID,
			&i.ZoneID,
			&i.Name,
			&i.Rrtype,
			&i.Content,
			&i.Ttl,
			&i.Managed,
			&i.ServiceID,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listDnsRecordsByZoneAndName = `-- name: ListDnsRecordsByZoneAndName :many
SELECT id, zone_id, name, rrtype, content, ttl, managed, service_id, created_at FROM dns_records
WHERE zone_id = $1 AND lower(name) = lower($2)
`

type ListDnsRecordsByZoneAndNameParams struct {
	ZoneID string `json:"zone_id"`
	Lower  string `json:"lower"`
}

func (q *Queries) ListDnsRecordsByZoneAndName(ctx context.Context, arg ListDnsRecordsByZoneAndNameParams) ([]DnsRecord, error) {
	rows, err := q.db.Query(ctx, listDnsRecordsByZoneAndName, arg.ZoneID, arg.Lower)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []DnsRecord{}
	for rows.Next() {
		var i DnsRecord
		if err := rows.Scan(
			&i.ID,
			&i.ZoneID,
			&i.Name,
			&i.Rrtype,
			&i.Content,
			&i.Ttl,
			&i.Managed,
			&i.ServiceID,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listDnsRecordsByZoneID = `-- name: ListDnsRecordsByZoneID :many
SELECT id, zone_id, name, rrtype, content, ttl, managed, service_id, created_at FROM dns_records
WHERE zone_id = $1
ORDER BY name, rrtype
`

func (q *Queries) ListDnsRecordsByZoneID(ctx context.Context, zoneID string) ([]DnsRecord, error) {
	rows, err := q.db.Query(ctx, listDnsRecordsByZoneID, zoneID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []DnsRecord{}
	for rows.Next() {
		var i DnsRecord
		if err := rows.Scan(
			&i.ID,
			&i.ZoneID,
			&i.Name,
			&i.Rrtype,
			&i.Content,
			&i.Ttl,
			&i.Managed,
			&i.ServiceID,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
